sudo: false
language: python
env: RUNNER=travis
python:
  - "2.7"
cache: pip
install: pip install -r requirements/dev.txt
before_script:
  - psql -c 'create database travis_ci_test;' -U postgres
  - psql -U postgres -d travis_ci_test -c "create extension postgis"
script:
  - coverage run --source=electionleaflets manage.py test
  - coverage run -a --source=electionleaflets manage.py harvest
after_success:
  - coveralls
notifications:
  slack: democracyclub:xPS8z1f2rT5iv25aeXtF6Ikl
cache:
  directories:
    - /home/travis/virtualenv
    - $HOME/.pip-cache/
addons:
  postgresql: "9.6"
  apt:
    packages:
    - postgresql-9.6-postgis-2.3
services:
  - redis-server
